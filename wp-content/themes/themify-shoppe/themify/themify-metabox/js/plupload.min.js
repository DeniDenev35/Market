function themify_create_pluploader(e){"use strict";var n=e,m=n.attr("id").replace("plupload-upload-ui",""),c=!1,u=!1,f=jQuery,e=JSON.parse(JSON.stringify(global_plupload_init));e.browse_button=m+e.browse_button,e.container=m+e.container,e.drop_element=m+e.drop_element,e.file_data_name=m+e.file_data_name,e.multipart_params.imgid=m,e.multipart_params._ajax_nonce=n.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu",""),n.hasClass("add-preset")&&(c=!0,e.multipart_params.haspreset="haspreset"),n.hasClass("add-preview")&&(u=!0,e.multipart_params.haspreview="haspreview"),n.hasClass("add-to-media")&&(e.multipart_params.tomedia="tomedia"),n.data("postid")&&(e.multipart_params.topost=n.data("postid")),n.data("fields")&&(e.multipart_params.fields=n.data("fields")),n.data("featured")&&(e.multipart_params.featured=n.data("featured")),n.data("formats")&&(e.filters[0].extensions=n.data("formats")),e.multipart_params.action=n.data("action");const a=new plupload.Uploader(e);a.bind("Init",function(e){}),a.init(),n.data("init",1),a.bind("FilesAdded",function(e,a){if(n.data("confirm")&&!confirm(n.data("confirm")))return;e.refresh(),e.start(),f(".tb_alert").addClass("busy").fadeIn(800)}),a.bind("Error",function(e,a){var t,o;f(".prompt-box .show-login").hide(),f(".prompt-box .show-error").show(),-600==a.code&&(t=themify_plupload_lang.filesize_error,o=themify_plupload_lang.filesize_error_fix),0<f(".prompt-box .show-error").length&&(f(".prompt-box .show-error").html('<p class="prompt-error">'+t+"</p>"),o)&&f(".prompt-box .show-error").append("<p>"+o+"</p>"),f(".overlay, .prompt-box").fadeIn(500);const r=document.getElementsByClassName("overlay");r[0]&&r[0].addEventListener("click",function(){f(".overlay, .prompt-box").fadeOut(500)},{once:!0})}),a.bind("FileUploaded",function(e,a,t){var o=JSON.parse(t.response),r="",r="200"==t.status&&o.success?"done":"error";if(f(".tb_alert").removeClass("busy").addClass(r).delay(800).fadeOut(800,function(){f(this).removeClass(r)}),o.success)if(f("#"+a.id).fadeOut(),o.data?.reload)window.location=location.href.replace(location.hash,"");else{const s=o.data.file,i=o.data.url;if(f("#"+m).val(i),void 0!==o.data.thumb&&(themifyMediaLib.setPreviewIcon(n.closest(".themify_field, .themify_field_row"),o.data.thumb),f("body").trigger("themify_plupload_selected",[n,o])),c){f("#"+m).closest("fieldset").children(".preset").find("img").removeClass("selected");const l=i.replace(/^.*[\\\/]/,""),d=f('<a href="#" title="'+l+'"><span title="'+s+'"></span><img src="'+i+'" alt="'+i+'" class="backgroundThumb selected" /></a>').css("display","inline-block");f("#"+m).closest("fieldset").children(".preset").append(d)}u&&f("#"+m+"-preview").attr("src",i)}else{f(".prompt-box .show-login").hide(),f(".prompt-box .show-error").show(),0<f(".prompt-box .show-error").length&&f(".prompt-box .show-error").html('<p class="prompt-error">'+o.data+"</p>"),f(".overlay, .prompt-box").fadeIn(500);const p=document.getElementsByClassName("overlay");void(p[0]&&p[0].addEventListener("click",function(){f(".overlay, .prompt-box").fadeOut(500)},{once:!0,passive:!0}))}})}!function($,r){"use strict";const e=function(){const e=$(".plupload-upload-uic");if(0<e.length&&e.each(function(){themify_create_pluploader($(this))}),!r.getElementsByClassName("prompt-box")[0]){const a=r.createElement("div"),t=r.createElement("div"),o=r.createElement("div");a.className="prompt-box",t.className="show-error",o.className="overlay",a.append(t),r.body.append(a,o)}};"complete"===document.readyState?e():window.addEventListener("load",e,{once:!0,passive:!0})}(jQuery,document);